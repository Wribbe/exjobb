<html>
  <head>
    <link rel="stylesheet" href="{{ url_for('static',filename='webapp.css') }}"></link>
    <title>Master Thesis Webapp</title>
  </head>
  <body>
    <div id='wrapper_page'>
      <div id='sidebar'>
        <form action='{{ url_for('webapp') }}' method='post'>
          {% for name in buttons %}
            <input type='submit' class='button_sidebar' name="btn_task_type" value="{{ name | title }}">
          {% endfor %}
          <input type='submit' class='button_sidebar button_abort' name='btn_abort' value="Abort Test"</input>
        </form>
      </div>
      <div id='main'>
        {% if task_started %}
          <div id='data'>
            {{data | safe}}
          </div>
        {% else %}
          <div id='info'>
            {% if not session.survey_initial %}
              <div id='initial_survey'>
                <h3> Initial Survey </h3>
                <form action='{{ url_for('webapp') }}' method='post'>
                  <table>
                    <tr>
                      <td>Anonymous id:</td>
                      <td>
                        <input type='text' name='key_user' value='{{session.id_user}}' disabled required>
                      </td>
                    </tr>
                    <tr>
                      <td>Age:</td>
                      <td><input type='number' step="1" min="0" value="25" required></td>
                    </tr>
                  </table>
                  <table id='initial_numbers'>
                    <tr>
                      {% for v in ["", 'Strongly Disagree', "","","", "Strongly Agree"] %}
                        {% if loop.first %}
                          <th class="noborder">{{v}}</th>
                        {% else %}
                          <th>{{v}}</th>
                        {% endif %}
                      {% endfor %}
                    </tr>
                    <tr>
                      <td class="noborder"></td>
                      {% for d in range(1,6) %}
                        <td>{{ d }}</td>
                      {% endfor %}
                    </tr>
                    {% for q in ["Q1"] %}
                      <td class="noborder">{{q}}:</td>
                      {% for _ in range(1,6) %}
                        <td>
                          <label>
                            <div class="input_div">
                              <input name="{{q}}" type='radio' required>
                            </div>
                          </label>
                        </td>
                      {% endfor %}
                    {% endfor %}
                  </table>
                  <input type='submit' class='button_start' name="btn_initial_survey" value="Submit">
                </form>
              </div>
            {% elif data %}
                {{data | safe}}
                <form action='{{ url_for('webapp') }}' method='post'>
                  <input type='submit' class='button_start' name="btn_task_start" value="Start Task">
                </form>
            {% else %}
              <div>
                User key: {{ session.id_user }}
              </div>
              <div>
                Test-stats:
                <ul class="stats_tests">
                  <li>Total tests completed: {{ stats.total }}</li>
                  <li>Remaining for survey: {{ [stats.required- stats.total, 0] | max }}</li>
                </ul>
              </div>
              <div>
                Types of tests done:
                <ul>
                  {% for type, num in stats.num_types.items() %}
                    <li> {{ num }} - {{ type | title}} </li>
                  {% endfor %}
                </ul>
              </div>
              <div>
                <form action="{{ url_for('webapp') }}" method="POST">
                  {% if stats.total < stats.required %}
                    <input class='button_sidebar' type="submit" name="btn_survey" value="Take Survey" disabled/>
                  {% else %}
                    <input class='button_sidebar' type="submit" name="btn_survey" value="Take Survey" />
                  {% endif %}
                </form>
              </div>
              <div>
                Select a task type to the left to continue.
              </div>
            {% endif %}
          </div>
        {% endif %}
      </div>
    </div>
  </body>
</html>
